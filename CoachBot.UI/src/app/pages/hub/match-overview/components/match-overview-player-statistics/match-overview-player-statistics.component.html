<div [class.container]="!showMoreStats" [class.container-fluid]="showMoreStats" [class.px-5]="showMoreStats">
    <div class="card card--has-table" style="margin-left: -30px; margin-right: -30px;">
        <header class="card__header card__header--has-btn">
            <h4>Player Statistics</h4>
            <ul class="team-result-filter d-none d-md-inline float-right">
                <li class="team-result-filter__item float-right">
                    <button type="button" class="btn btn-secondary btn-xs d-none d-lg-inline-block mr-2"
                        (click)="toggleStatAggregation()">
                        Show
                        <ng-container *ngIf="showAggregateStats">Position</ng-container>
                        <ng-container *ngIf="!showAggregateStats">Aggregate</ng-container>
                        Stats
                    </button>
                    <button type="button" class="btn btn-secondary btn-xs d-none d-lg-inline-block"
                        (click)="showMoreStats = !showMoreStats">
                        Show
                        <ng-container *ngIf="!showMoreStats">More</ng-container>
                        <ng-container *ngIf="showMoreStats">Fewer</ng-container>
                        Stats
                    </button>
                </li>
            </ul>
        </header>
        <div class="card__content table-responsive">
            <app-spinner *ngIf="isLoading"></app-spinner>
            <table *ngIf="!isLoading"
                class="table table--large table-striped table-hover table-clickable table-inner-border table-column-hover"
                [class.widget__content--loading]="isSorting">
                <thead>
                    <tr>
                        <th sorter [sortByColumn]="'Team.TeamCode'" [sortByColumnName]="'Team'" [currentSort]="sortBy"
                            [currentOrder]="sortOrder" (sort)="loadResults($event)" class="text-center"></th>
                        <th *ngIf="!showAggregateStats" sorter [sortByColumn]="'Position.Name'"
                            [sortByColumnName]="'Pos'" [currentSort]="sortBy" [currentOrder]="sortOrder"
                            (sort)="loadResults($event)" class="text-center" title="Position">
                        </th>
                        <th sorter [sortByColumn]="'Player.Name'" [sortByColumnName]="'Player'" [currentSort]="sortBy"
                            [currentOrder]="sortOrder" (sort)="loadResults($event)" class="text-center"></th>
                        <th class="text-center"></th>
                        <th sorter [sortByColumn]="'Goals'" [currentSort]="sortBy" [currentOrder]="sortOrder"
                            (sort)="loadResults($event)" class="text-center"></th>
                        <th sorter [sortByColumn]="'Shots'" [sortByColumnName]="'Shots'" [currentSort]="sortBy"
                            [currentOrder]="sortOrder" (sort)="loadResults($event)" class="text-center">
                        </th>
                        <th sorter [sortByColumn]="'ShotsOnGoal'" [sortByColumnName]="'“ On Target'"
                            [currentSort]="sortBy" [currentOrder]="sortOrder" (sort)="loadResults($event)"
                            class="text-center">
                        </th>
                        <th sorter [sortByColumn]="'Assists'" [currentSort]="sortBy" [currentOrder]="sortOrder"
                            (sort)="loadResults($event)" class="text-center"></th>
                        <th sorter [sortByColumn]="'Passes'" [sortByColumnName]="'Passes'" [currentSort]="sortBy"
                            [currentOrder]="sortOrder" (sort)="loadResults($event)" class="text-center">
                        </th>
                        <th sorter [sortByColumn]="'PassesCompleted'" [sortByColumnName]="'“ Completed'"
                            [currentSort]="sortBy" [currentOrder]="sortOrder" (sort)="loadResults($event)"
                            class="text-center"></th>
                        <th sorter [sortByColumn]="'PassCompletionPercentage'" [sortByColumnName]="'“ %'"
                            [currentSort]="sortBy" [currentOrder]="sortOrder" (sort)="loadResults($event)"
                            class="text-center"></th>
                        <th sorter [sortByColumn]="'Interceptions'" [sortByColumnName]="'Ints'" [currentSort]="sortBy"
                            [currentOrder]="sortOrder" (sort)="loadResults($event)" class="text-center"
                            title="Interceptions"></th>
                        <th sorter [sortByColumn]="'PossessionPercentage'" [sortByColumnName]="'Poss'"
                            [currentSort]="sortBy" [currentOrder]="sortOrder" (sort)="loadResults($event)"
                            title="Possession %" class="text-center"></th>
                        <th sorter [sortByColumn]="'KeeperSaves'" [sortByColumnName]="'Saves'" [currentSort]="sortBy"
                            [currentOrder]="sortOrder" (sort)="loadResults($event)" class="text-center"></th>
                        <th *ngIf="showMoreStats" sorter [sortByColumn]="'Offsides'" [currentSort]="sortBy"
                            [currentOrder]="sortOrder" (sort)="loadResults($event)" class="text-center"></th>
                        <th *ngIf="showMoreStats" sorter [sortByColumn]="'DistanceCovered'"
                            [sortByColumnName]="'Distance'" [currentSort]="sortBy" [currentOrder]="sortOrder"
                            (sort)="loadResults($event)" class="text-center"></th>
                        <th *ngIf="showMoreStats" sorter [sortByColumn]="'Fouls'" [currentSort]="sortBy"
                            [currentOrder]="sortOrder" (sort)="loadResults($event)" class="text-center"></th>
                        <th *ngIf="showMoreStats" sorter [sortByColumn]="'FoulsSuffered'"
                            [sortByColumnName]="'“ Suffered'" [currentSort]="sortBy" [currentOrder]="sortOrder"
                            (sort)="loadResults($event)" class="text-center"></th>
                        <th *ngIf="showMoreStats" sorter [sortByColumn]="'OwnGoals'" [sortByColumnName]="'Own Goals'"
                            [currentSort]="sortBy" [currentOrder]="sortOrder" (sort)="loadResults($event)"
                            class="text-center"></th>
                        <th *ngIf="showMoreStats" sorter [sortByColumn]="'GoalsConceded'"
                            [sortByColumnName]="'Goals Conceded'" [currentSort]="sortBy" [currentOrder]="sortOrder"
                            (sort)="loadResults($event)" class="text-center"></th>
                        <th *ngIf="showMoreStats" sorter [sortByColumn]="'Corners'" [currentSort]="sortBy"
                            [currentOrder]="sortOrder" (sort)="loadResults($event)" class="text-center"></th>
                        <th *ngIf="showMoreStats" sorter [sortByColumn]="'ThrowIns'" [sortByColumnName]="'Throw Ins'"
                            [currentSort]="sortBy" [currentOrder]="sortOrder" (sort)="loadResults($event)"
                            class="text-center"></th>
                        <th *ngIf="showMoreStats" sorter [sortByColumn]="'FreeKicks'" [sortByColumnName]="'Free Kicks'"
                            [currentSort]="sortBy" [currentOrder]="sortOrder" (sort)="loadResults($event)"
                            class="text-center"></th>
                        <th *ngIf="showMoreStats" sorter [sortByColumn]="'GoalKicks'" [sortByColumnName]="'Goal Kicks'"
                            [currentSort]="sortBy" [currentOrder]="sortOrder" (sort)="loadResults($event)"
                            class="text-center"></th>
                        <th *ngIf="showMoreStats" sorter [sortByColumn]="'Penalties'" [currentSort]="sortBy"
                            [currentOrder]="sortOrder" (sort)="loadResults($event)" class="text-center"></th>
                        <th *ngIf="showMoreStats" sorter [sortByColumn]="'YellowCards'"
                            [sortByColumnName]="'Yellow Cards'" [currentSort]="sortBy" [currentOrder]="sortOrder"
                            (sort)="loadResults($event)" class="text-center"></th>
                        <th *ngIf="showMoreStats" sorter [sortByColumn]="'RedCards'" [sortByColumnName]="'Red Cards'"
                            [currentSort]="sortBy" [currentOrder]="sortOrder" (sort)="loadResults($event)"
                            class="text-center"></th>

                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let player of players" (click)="navigateToPlayerProfile(player.playerId)"
                        title="View player's profile" [style.border-left-color]="player.team.color"
                        style="border-left: 5px solid transparent;">
                        <td class="team-result__status">{{player.team.teamCode}}</td>
                        <td *ngIf="!showAggregateStats">{{player.position.name}}</td>
                        <td class="team-result__score">{{player.nickname}}</td>
                        <td class="text-center text-nowrap">
                            <span *ngIf="player.substitute" title="Substitute">
                                <i class="icon-svg icon-in mr-1"></i>
                            </span>
                            <span *ngIf="player.yellowCards > 0" title="Yellow carded">
                                <i class="icon-svg icon-yellow-card mr-1"></i>
                            </span>
                            <span *ngIf="player.redCards > 0" title="Red carded">
                                <i class="icon-svg icon-red-card mr-1"></i>
                            </span>
                            <span *ngIf="!showAggregateStats && player.position.name == 'GK' && !player.goalsConceded" title="Clean sheet">
                                <i  class="icon-svg icon-keepers-glove"></i>
                            </span>
                        </td>
                        <td class="text-center">{{player.goals}}</td>
                        <td class="text-center">{{player.shots}}</td>
                        <td class="text-center">{{player.shotsOnGoal}}</td>
                        <td class="text-center">{{player.assists}}</td>
                        <td class="text-center">{{player.passes}}</td>
                        <td class="text-center">{{player.passesCompleted}}</td>
                        <td class="text-center">{{player.passCompletionPercentage | number : '1.2-2' | percent }}
                        </td>
                        <td class="text-center">{{player.interceptions}}</td>
                        <td class="text-center">{{player.possessionPercentage | number : '1.0-0'}}%</td>
                        <td class="text-center">{{ player.keeperSaves ? player.keeperSaves : 'N/A'}}</td>
                        <td *ngIf="showMoreStats" class="text-center">{{player.offsides}}</td>
                        <td *ngIf="showMoreStats" class="text-center">
                            {{(player.distanceCovered / 1000) | number : '1.2-2'}}km</td>
                        <td *ngIf="showMoreStats" class="text-center">{{player.fouls}}</td>
                        <td *ngIf="showMoreStats" class="text-center">{{player.foulsSuffered}}</td>
                        <td *ngIf="showMoreStats" class="text-center">{{player.ownGoals}}</td>
                        <td *ngIf="showMoreStats" class="text-center">{{player.goalsConceded}}</td>
                        <td *ngIf="showMoreStats" class="text-center">{{player.corners}}</td>
                        <td *ngIf="showMoreStats" class="text-center">{{player.throwIns}}</td>
                        <td *ngIf="showMoreStats" class="text-center">{{player.freeKicks}}</td>
                        <td *ngIf="showMoreStats" class="text-center">{{player.goalKicks}}</td>
                        <td *ngIf="showMoreStats" class="text-center">{{player.penalties}}</td>
                        <td *ngIf="showMoreStats" class="text-center">{{player.yellowCards}}</td>
                        <td *ngIf="showMoreStats" class="text-center">{{player.redCards}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>